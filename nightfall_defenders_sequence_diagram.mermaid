sequenceDiagram
    participant G as Game
    participant W as Window
    participant R as Renderer
    participant P as PhysicsEngine
    participant WD as World
    participant C as Character
    participant A as Ability

    G->>W: create()
    G->>R: init()
    G->>P: init()
    G->>WD: init()

    loop Game Loop
        G->>W: poll_events()
        G->>WD: update(dt)
        WD->>C: update(dt)
        C->>A: update(dt)
        G->>P: update(dt)
        P->>P: solve_verlet()
        P->>P: check_collisions()
        G->>R: begin_frame()
        G->>WD: render()
        WD->>C: render()
        C->>A: render()
        G->>R: end_frame()
        G->>W: swap_buffers()
    end

    rect rgb(200, 150, 150)
        note right of C: Ability Usage Flow
        C->>A: cast(source, target)
        A->>P: calculate_trajectory()
        P-->>A: trajectory_points
        A->>WD: spawn_projectile()
    end

    rect rgb(150, 200, 150)
        note right of WD: Day/Night Transition
        WD->>WD: update_time()
        WD->>WD: handle_day_night_transition()
        WD->>WD: spawn_night_enemies()
    end